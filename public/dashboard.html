<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Ads Manager by Quinn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <style>
        [v-cloak] { display: none !important; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        #app-loading { position: fixed; inset: 0; background: #F3F4F6; z-index: 9999; display: flex; justify-content: center; align-items: center; flex-direction: column; }
        .animate-scale-up { animation: scaleUp 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes scaleUp { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body class="bg-[#F3F4F6] h-screen overflow-hidden flex font-[Prompt]">

    <!-- Loading Screen -->
    <div id="app-loading">
        <i class="fa-solid fa-circle-notch fa-spin text-4xl text-indigo-600 mb-4"></i>
        <h2 class="text-gray-600 font-bold">Quinn AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</h2>
    </div>

    <div id="app" class="flex w-full h-full relative" v-cloak>
        
        <!-- Mobile Overlay -->
        <div v-if="isSidebarOpen" @click="isSidebarOpen = false" class="fixed inset-0 bg-black/50 z-30 md:hidden transition-opacity"></div>

        <!-- Sidebar -->
        <aside :class="isSidebarOpen ? 'translate-x-0' : '-translate-x-full'" class="fixed inset-y-0 left-0 z-40 w-64 bg-white border-r border-gray-200 flex-shrink-0 flex flex-col justify-between h-full shadow-lg transform transition-transform duration-300 ease-in-out md:relative md:translate-x-0">
            <div>
                <div class="h-16 flex items-center px-6 border-b border-gray-100 bg-white">
                    <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white mr-3 shadow-md"><i class="fa-solid fa-robot"></i></div>
                    <span class="font-bold text-xl text-gray-800 tracking-tight">Quinn AI</span>
                    <button @click="isSidebarOpen = false" class="ml-auto md:hidden text-gray-400 hover:text-gray-600"><i class="fa-solid fa-times"></i></button>
                </div>

                <!-- Membership Banner -->
                <div class="px-4 mt-4">
                    <div class="bg-gradient-to-r from-gray-900 to-black text-white p-4 rounded-xl shadow-lg relative overflow-hidden group cursor-pointer">
                        <div class="absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl group-hover:scale-150 transition"></div>
                        <div class="relative z-10">
                            <p class="text-[10px] uppercase font-bold text-gray-400 tracking-widest">Current Plan</p>
                            <h3 class="text-lg font-bold flex items-center gap-2">
                                <i class="fa-solid fa-crown text-yellow-400" v-if="userPlan?.plan === 'pro'"></i>
                                <span class="capitalize">{{ userPlan?.plan || 'Loading...' }}</span>
                            </h3>
                            <p v-if="userPlan?.expire" class="text-[10px] text-gray-400 mt-1">Exp: {{ new Date(userPlan.expire).toLocaleDateString() }}</p>
                            <button v-if="userPlan?.plan === 'free'" class="mt-3 w-full bg-white/20 hover:bg-white/30 text-white text-xs py-2 rounded-lg font-bold transition">üî• Upgrade Now</button>
                        </div>
                    </div>
                </div>

                <!-- Profile Button -->
                <div class="px-4 mt-4 text-center">
                    <button @click="openModal('profile')" class="text-xs text-gray-500 hover:text-indigo-600 underline transition flex items-center justify-center gap-1 w-full py-1">
                        <i class="fa-solid fa-user-gear"></i> Manage Profile & Security
                    </button>
                </div>

                <nav class="p-4 space-y-1">
                    <div class="px-4 mt-4 mb-2 text-[10px] font-extrabold text-gray-400 uppercase tracking-widest">Main Menu</div>
                    <a href="#" @click.prevent="currentView = 'overview'; isSidebarOpen = false" :class="{'active': currentView === 'overview'}" class="nav-item flex items-center px-4 py-3 rounded-xl mb-1 text-sm font-medium transition-all duration-200"><i class="fa-solid fa-chart-pie w-6 mr-2 text-lg"></i> ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</a>
                    
                    <div class="px-4 mt-6 mb-2 text-[10px] font-extrabold text-gray-400 uppercase tracking-widest">Platforms</div>
                    <a v-if="checkAccess('facebook')" href="#" @click.prevent="currentView = 'facebook'; isSidebarOpen = false" :class="{'active': currentView === 'facebook'}" class="nav-item flex items-center px-4 py-3 rounded-xl mb-1 text-sm font-medium transition-all duration-200"><i class="fa-brands fa-facebook w-6 mr-2 text-lg text-blue-600"></i> Facebook Ads</a>
                    <a v-if="checkAccess('tiktok')" href="#" @click.prevent="currentView = 'tiktok'; isSidebarOpen = false" :class="{'active': currentView === 'tiktok'}" class="nav-item flex items-center px-4 py-3 rounded-xl mb-1 text-sm font-medium transition-all duration-200"><i class="fa-brands fa-tiktok w-6 mr-2 text-lg text-black"></i> TikTok Ads</a>

                    <div class="px-4 mt-6 mb-2 text-[10px] font-extrabold text-gray-400 uppercase tracking-widest">System</div>
                    <a v-if="user && user.role === 'admin'" href="admin.html" class="flex items-center px-4 py-3 text-white bg-gray-800 rounded-xl font-bold mt-4 hover:bg-black transition shadow-lg transform hover:scale-[1.02]"><i class="fa-solid fa-crown w-6 mr-2 text-yellow-400"></i> Super Admin</a>
                </nav>
            </div>
            <div class="p-4 border-t border-gray-100 bg-gray-50/50"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-gradient-to-r from-blue-100 to-indigo-100 flex items-center justify-center text-indigo-600 font-bold border border-white shadow-sm uppercase">{{ user.name ? user.name[0] : 'U' }}</div><div class="flex-1 min-w-0"><p class="text-sm font-bold text-gray-900 truncate">{{ user.name }}</p><p class="text-xs text-green-500 font-medium truncate">Online</p></div><button @click="logout" class="text-xs text-gray-500 hover:text-red-500 transition flex items-center gap-1"><i class="fa-solid fa-right-from-bracket"></i></button></div></div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col h-full overflow-hidden relative bg-[#F3F4F6]">
            <!-- Announcement -->
            <div v-if="announcement && announcement.isActive" class="w-full px-4 py-2.5 text-center text-sm font-bold flex justify-center items-center gap-2 shadow-md z-40 transition-all transform origin-top" :class="announcement.type === 'danger' ? 'bg-red-600 text-white' : (announcement.type === 'warning' ? 'bg-yellow-400 text-black' : 'bg-indigo-600 text-white')"><i class="fa-solid fa-bullhorn animate-bounce"></i> <span>{{ announcement.message }}</span></div>
            
            <header class="h-20 bg-white/80 backdrop-blur-md border-b border-gray-200 flex items-center justify-between px-4 md:px-8 flex-shrink-0 sticky top-0 z-10">
                <div class="flex items-center gap-3">
                    <button @click="isSidebarOpen = true" class="md:hidden text-gray-600 hover:text-indigo-600 transition"><i class="fa-solid fa-bars text-2xl"></i></button>
                    <div><h1 class="text-lg md:text-xl font-bold text-gray-800 capitalize flex items-center gap-2"><span v-if="currentView === 'overview'">üìä <span class="hidden md:inline">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</span></span><span v-if="currentView === 'facebook'">üíô <span class="hidden md:inline">Facebook Manager</span></span><span v-if="currentView === 'tiktok'">üñ§ <span class="hidden md:inline">TikTok Manager</span></span></h1><p class="text-xs text-gray-400 mt-0.5 hidden md:block">Quinn AI: ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏±‡∏ö, {{ user.name }}</p></div>
                </div>
                <div class="flex items-center gap-2 bg-gray-100/50 p-1 rounded-xl border border-gray-200/50">
                    <button @click="openModal('audience')" class="flex items-center gap-2 px-3 py-2 bg-white text-purple-600 rounded-lg text-xs font-bold border border-gray-200 shadow-sm hover:shadow-md hover:text-purple-700 transition"><i class="fa-solid fa-users-viewfinder"></i> <span class="hidden md:inline">Audience Lab</span></button>
                    <button @click="openModal('spy')" class="flex items-center gap-2 px-3 py-2 bg-white text-gray-700 rounded-lg text-xs font-bold border border-gray-200 shadow-sm hover:shadow-md hover:text-black transition"><i class="fa-solid fa-user-secret"></i> <span class="hidden md:inline">Spy Tool</span></button>
                </div>
            </header>

            <div class="flex-1 overflow-y-auto p-4 md:p-8 custom-scrollbar">
                
                <!-- Overview View -->
                <div v-if="currentView === 'overview'" class="space-y-6 animate-fade-in">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100"><p class="text-xs text-gray-400 font-bold uppercase mb-1">SPEND</p><h3 class="text-2xl font-bold text-gray-800">{{ totalStats.spend.toLocaleString() }} ‡∏ø</h3></div>
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100"><p class="text-xs text-gray-400 font-bold uppercase mb-1">SALES</p><h3 class="text-2xl font-bold text-green-600">{{ totalStats.sales.toLocaleString() }} ‡∏ø</h3></div>
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100"><p class="text-xs text-gray-400 font-bold uppercase mb-1">ROAS</p><h3 class="text-2xl font-bold text-indigo-600">{{ totalStats.roas }}</h3></div>
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100"><p class="text-xs text-gray-400 font-bold uppercase mb-1">PROFIT</p><h3 class="text-2xl font-bold" :class="totalStats.profit > 0 ? 'text-green-600' : 'text-red-500'">{{ totalStats.profit.toLocaleString() }} ‡∏ø</h3></div>
                    </div>
                </div>

                <!-- Facebook View -->
                <div v-if="currentView === 'facebook' && checkAccess('facebook')" class="space-y-6 animate-fade-in">
                    
                    <!-- Not Connected State -->
                    <div v-if="!settings.fbToken" class="flex flex-col items-center justify-center py-20 bg-white rounded-3xl shadow-sm border border-gray-100">
                        <div class="w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mb-6"><i class="fa-brands fa-facebook text-4xl text-blue-600"></i></div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Connect to Facebook Ads</h2>
                        <p class="text-gray-500 mb-8 max-w-md text-center">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö AI ‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</p>
                        <button @click="connectFacebook" class="bg-[#1877F2] hover:bg-[#156ad6] text-white px-8 py-4 rounded-xl font-bold shadow-xl shadow-blue-200 transition transform hover:-translate-y-1 flex items-center gap-3 text-lg mt-4"><i class="fa-brands fa-facebook-f"></i> Connect</button>
                    </div>

                    <!-- Connected State -->
                    <div v-else-if="settings.autoScale" class="space-y-6">
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            
                            <!-- Col 1: Account -->
                            <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex flex-col justify-between">
                                <div>
                                    <h3 class="text-xs font-bold text-gray-400 uppercase mb-3 flex items-center gap-2"><i class="fa-solid fa-user-circle text-gray-500"></i> ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</h3>
                                    <select v-model="settings.adAccountId" @change="saveSettings(false); checkAdsNow()" class="w-full bg-gray-50 border border-gray-200 text-gray-800 text-sm rounded-xl p-3 font-bold focus:ring-2 focus:ring-indigo-500 outline-none mb-2">
                                        <option value="" disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Ad Account --</option>
                                        <option v-for="acc in adAccountsList" :key="acc.id" :value="acc.id">{{ acc.name }} ({{ acc.currency }})</option>
                                    </select>
                                    <div class="flex items-center gap-2 mt-2"><span class="px-2 py-1 bg-green-100 text-green-700 rounded text-[10px] font-bold border border-green-200"><i class="fa-solid fa-circle-check"></i> Connected</span></div>
                                </div>
                                <button @click="disconnectFacebook" class="text-xs text-red-400 hover:text-red-600 font-bold underline mt-4 text-left">Disconnect</button>
                            </div>

                            <!-- Col 2: Bot Settings -->
                            <div class="bg-white p-5 rounded-2xl shadow-sm border border-indigo-100 relative overflow-hidden flex flex-col justify-between">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="text-sm font-bold text-indigo-900 flex items-center gap-2"><i class="fa-solid fa-robot text-indigo-500"></i> Bot Rules</h3>
                                    <div class="flex items-center gap-2">
                                        <span class="text-[10px] text-gray-400 font-bold">{{ settings.isBotActive ? 'ON' : 'OFF' }}</span>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" v-model="settings.isBotActive" @change="saveSettings(false)" class="sr-only peer">
                                            <div class="w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-indigo-600"></div>
                                        </label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <p class="text-[9px] text-gray-400 font-bold uppercase mb-2 flex items-center gap-1"><i class="fa-solid fa-shield-halved"></i> Safety Zone</p>
                                    <div class="grid grid-cols-3 gap-2">
                                        <div><label class="text-[9px] text-gray-400 block mb-1">Stop Loss</label><input v-model.number="settings.stopLossLimit" @change="saveSettings(false)" type="number" class="w-full border bg-gray-50 rounded-lg p-1.5 text-xs font-bold text-center focus:ring-1 focus:ring-indigo-500 outline-none"></div>
                                        <div><label class="text-[9px] text-gray-400 block mb-1">Target ROAS</label><input v-model.number="settings.targetRoas" @change="saveSettings(false)" type="number" step="0.1" class="w-full border bg-gray-50 rounded-lg p-1.5 text-xs font-bold text-center text-indigo-600 focus:ring-1 focus:ring-indigo-500 outline-none"></div>
                                        <div><label class="text-[9px] text-gray-400 block mb-1">Profit %</label><input v-model.number="settings.profitMargin" @change="saveSettings(false)" type="number" class="w-full border bg-gray-50 rounded-lg p-1.5 text-xs font-bold text-center text-green-600 focus:ring-1 focus:ring-indigo-500 outline-none"></div>
                                    </div>
                                </div>
                                <div class="border-t border-gray-100 mb-3"></div>
                                <div>
                                    <p class="text-[9px] text-gray-400 font-bold uppercase mb-2 flex items-center gap-1"><i class="fa-solid fa-chart-line"></i> Growth Zone</p>
                                    <div class="grid grid-cols-2 gap-2">
                                        <div><label class="text-[9px] text-gray-400 block mb-1">Scale Up (%)</label><input v-model.number="settings.autoScale.increasePercent" @change="saveSettings(false)" type="number" placeholder="20" class="w-full border bg-gray-50 rounded-lg p-1.5 text-xs font-bold text-center text-blue-600 focus:ring-1 focus:ring-blue-500 outline-none"></div>
                                        <div><label class="text-[9px] text-gray-400 block mb-1">Global Max Cap (‡∏ø)</label><input v-model.number="settings.autoScale.maxBudget" @change="saveSettings(false)" type="number" placeholder="5000" class="w-full border bg-gray-50 rounded-lg p-1.5 text-xs font-bold text-center text-red-500 focus:ring-1 focus:ring-red-500 outline-none"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Col 3: Actions -->
                            <div class="flex flex-col gap-3">
                                <button @click="openModal('launcher')" class="flex-1 bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white rounded-2xl shadow-lg shadow-blue-200 transition transform hover:-translate-y-0.5 flex flex-col items-center justify-center p-4 group">
                                    <i class="fa-solid fa-rocket text-2xl mb-2 group-hover:scale-110 transition"></i>
                                    <span class="font-bold">Create New Campaign</span>
                                    <span class="text-[10px] opacity-80 font-normal">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏î‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢ AI</span>
                                </button>
                                <button @click="checkAdsNow" :disabled="loading" class="bg-white border border-gray-200 hover:bg-gray-50 text-gray-600 py-3 rounded-xl text-sm font-bold shadow-sm transition flex items-center justify-center gap-2"><i :class="loading ? 'fa-solid fa-circle-notch fa-spin' : 'fa-solid fa-rotate'"></i> ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100"><div class="h-72 w-full"><canvas id="spendChart"></canvas></div></div>

                        <!-- Ads Table -->
                        <div class="bg-white rounded-2xl shadow-sm overflow-hidden border border-gray-100">
                            <div class="p-5 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center"><span class="font-bold text-gray-700">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (Ads Performance)</span></div>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm text-left whitespace-nowrap">
                                    <thead class="bg-gray-50 text-gray-500 text-xs uppercase font-bold tracking-wider">
                                        <tr>
                                            <th class="p-4 pl-6 text-center w-10">üöÄ Scale</th>
                                            <th class="p-4">‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏î</th>
                                            <th class="p-4 text-right">‡∏à‡πà‡∏≤‡∏¢ (‡∏ø)</th>
                                            <th class="p-4 text-center w-32">Max Cap (‡∏ø)</th>
                                            <th class="p-4 text-right">Cost/Msg</th>
                                            <th class="p-4 text-center">ROAS</th>
                                            <th class="p-4 text-center">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-100">
                                        <tr v-for="ad in paginatedAds" :key="ad.id" class="hover:bg-blue-50/30 transition">
                                            <td class="p-4 text-center">
                                                <input type="checkbox" :checked="settings.autoScale?.whitelistedAds?.includes(ad.id)" @change="toggleAdScale(ad.id)" class="w-5 h-5 text-orange-500 rounded cursor-pointer accent-indigo-600">
                                            </td>
                                            <td class="p-4 font-medium text-gray-700">{{ ad.name }} <div class="text-[10px] text-gray-400">ID: {{ ad.id }}</div></td>
                                            <td class="p-4 text-right font-bold">{{ ad.spend.toLocaleString() }}</td>
                                            
                                            <td class="p-4 text-center">
                                                <div class="relative flex items-center justify-center">
                                                    <input 
                                                        type="number" 
                                                        v-model.lazy="settings.autoScale.adLimits[ad.id]" 
                                                        @change="saveSettings(false)"
                                                        :disabled="!settings.autoScale?.whitelistedAds?.includes(ad.id)"
                                                        :placeholder="settings.autoScale.maxBudget" 
                                                        class="w-24 border border-gray-200 rounded-lg p-1.5 text-xs text-center font-bold focus:ring-1 focus:ring-indigo-500 outline-none disabled:bg-gray-50 disabled:text-gray-400 placeholder-gray-300"
                                                    >
                                                    <span v-if="!settings.autoScale?.adLimits?.[ad.id]" class="absolute text-[9px] text-gray-300 pointer-events-none mt-6">(Global)</span>
                                                </div>
                                            </td>

                                            <td class="p-4 text-right">{{ ad.costPerMsg }}</td>
                                            <td class="p-4 text-center"><span :class="ad.roas >= settings.targetRoas ? 'text-green-600 font-bold' : 'text-gray-500'">{{ ad.roas }}</span></td>
                                            <td class="p-4 text-center font-bold text-xs" :class="getStatusClass(ad.status)">{{ ad.status }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div v-if="currentView === 'tiktok'" class="text-center py-20 text-gray-500"><h3 class="text-xl font-bold">üéµ TikTok Ads Manager</h3><p>Coming Soon...</p></div>

            </div>
        </main>

        <!-- Modals -->
        <div v-show="activeModal === 'ai'" style="display: none;" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm" @click.self="closeModal"><div class="bg-white rounded-3xl w-full max-w-lg p-6"><button @click="closeModal" class="float-right">X</button><h3 class="font-bold text-lg mb-4">AI Writer</h3><input v-model="aiForm.product" class="border p-2 w-full mb-2" placeholder="Product..."><button @click="generateCopy" class="bg-purple-600 text-white px-4 py-2 rounded">Generate</button><textarea v-if="aiResult" :value="aiResult" class="w-full h-32 border p-2 mt-2"></textarea></div></div>
        <div v-show="activeModal === 'hunter'" style="display: none;" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm" @click.self="closeModal"><div class="bg-white rounded-3xl w-full max-w-2xl p-6"><button @click="closeModal" class="float-right">X</button><h3 class="font-bold text-lg mb-4">Interest Hunter</h3><input v-model="hunterKeyword" class="border p-2 w-full mb-2" placeholder="Keyword..."><button @click="searchInterests" class="bg-indigo-600 text-white px-4 py-2 rounded">Search</button><div class="mt-2"><div v-for="i in interestResults" class="border-b p-2">{{ i.name }}</div></div></div></div>
        
        <!-- Launcher (‡∏£‡∏ß‡∏° Interest Hunter & AI) -->
        <div v-show="activeModal === 'launcher'" style="display: none;" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm" @click.self="closeModal">
            <div class="bg-white rounded-3xl w-full max-w-4xl h-[90vh] flex flex-col overflow-hidden shadow-2xl animate-scale-up">
                <div class="px-8 py-5 border-b border-gray-100 flex justify-between items-center bg-gray-50/50">
                    <div><h3 class="font-bold text-xl text-gray-800"><i class="fa-solid fa-rocket text-indigo-600 mr-2"></i>Create New Campaign</h3><p class="text-xs text-gray-400">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏î‡πâ‡∏ß‡∏¢ AI</p></div>
                    <button @click="closeModal" class="w-8 h-8 rounded-full bg-gray-100 text-gray-400 hover:bg-gray-200 hover:text-red-500 transition flex items-center justify-center"><i class="fa-solid fa-times"></i></button>
                </div>
                <div class="flex-1 overflow-y-auto p-8 bg-gray-50">
                    
                    <!-- Step 1 -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 mb-6">
                        <h4 class="font-bold text-gray-700 mb-4 flex items-center gap-2"><span class="bg-indigo-100 text-indigo-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">1</span> ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h4>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="col-span-2">
                                <label class="block text-xs font-bold text-gray-400 mb-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏à‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏¥‡∏á‡πÅ‡∏≠‡∏î</label>
                                <div class="relative"><select v-model="launcher.pageId" class="w-full border border-gray-200 rounded-xl px-4 py-2.5 text-sm focus:ring-2 focus:ring-indigo-500 outline-none appearance-none bg-white"><option value="" disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏à --</option><option v-for="page in facebookPagesList" :key="page.id" :value="page.id">{{ page.name }}</option></select><div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-500"><i class="fa-solid fa-chevron-down text-xs"></i></div></div>
                            </div>
                            <div><label class="block text-xs font-bold text-gray-400 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç</label><input v-model="launcher.campaignName" type="text" class="w-full border border-gray-200 rounded-xl px-4 py-2.5 text-sm focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô: Quinn AI - ‡πÇ‡∏õ‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà"></div>
                            <div><label class="block text-xs font-bold text-gray-400 mb-1">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì / ‡∏ß‡∏±‡∏ô</label><input v-model.number="launcher.budget" type="number" class="w-full border border-gray-200 rounded-xl px-4 py-2.5 text-sm focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="1000"></div>
                        </div>
                    </div>

                    <!-- Step 2 -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 mb-6">
                        <h4 class="font-bold text-gray-700 mb-4 flex items-center gap-2"><span class="bg-indigo-100 text-indigo-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">2</span> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå (AI Writer)</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div @click="triggerImageUpload" class="border-2 border-dashed border-gray-200 rounded-xl p-6 text-center hover:border-indigo-400 transition cursor-pointer group bg-gray-50 flex flex-col items-center justify-center min-h-[200px]">
                                <div v-if="launcher.selectedImagePreview" class="relative w-full h-full"><img :src="launcher.selectedImagePreview" class="h-40 mx-auto rounded-lg shadow-md object-cover"><button @click.stop="launcher.selectedImage = null; launcher.selectedImagePreview = null" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 text-xs shadow-md flex items-center justify-center hover:bg-red-600"><i class="fa-solid fa-times"></i></button></div>
                                <div v-else><i class="fa-regular fa-image text-4xl text-gray-300 mb-3 group-hover:text-indigo-500 transition"></i><p class="text-sm font-bold text-gray-500">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</p><p class="text-xs text-gray-400 mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö .jpg, .png</p></div>
                                <input type="file" @change="handleImageUpload" class="hidden" ref="imageInput" accept="image/*">
                            </div>
                            <div class="flex flex-col h-full">
                                <div class="flex justify-between items-center mb-2"><label class="text-xs font-bold text-gray-400">Caption & AI Tone</label></div>
                                <div class="flex gap-2 mb-2 overflow-x-auto pb-1">
                                    <button @click="quickGenerateAi('hard-sell')" class="px-3 py-1 bg-red-50 text-red-600 border border-red-100 rounded-full text-[10px] font-bold hover:bg-red-100 transition whitespace-nowrap"><i class="fa-solid fa-fire mr-1"></i> ‡∏Ç‡∏≤‡∏¢‡πÇ‡∏´‡∏î</button>
                                    <button @click="quickGenerateAi('friendly')" class="px-3 py-1 bg-green-50 text-green-600 border border-green-100 rounded-full text-[10px] font-bold hover:bg-green-100 transition whitespace-nowrap"><i class="fa-solid fa-face-smile mr-1"></i> ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏≠‡∏á</button>
                                    <button @click="quickGenerateAi('promo')" class="px-3 py-1 bg-orange-50 text-orange-600 border border-orange-100 rounded-full text-[10px] font-bold hover:bg-orange-100 transition whitespace-nowrap"><i class="fa-solid fa-tags mr-1"></i> ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</button>
                                    <button @click="quickGenerateAi('educated')" class="px-3 py-1 bg-blue-50 text-blue-600 border border-blue-100 rounded-full text-[10px] font-bold hover:bg-blue-100 transition whitespace-nowrap"><i class="fa-solid fa-graduation-cap mr-1"></i> ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ</button>
                                </div>
                                <div class="relative w-full">
                                    <textarea v-model="launcher.caption" class="w-full border border-gray-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500 outline-none bg-gray-50 resize-none" placeholder="‡πÉ‡∏™‡πà‡πÅ‡∏Ñ‡∏õ‡∏ä‡∏±‡πà‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Tone ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô..." rows="10"></textarea>
                                    <div v-if="aiLoading" class="absolute inset-0 bg-white/80 flex items-center justify-center rounded-xl z-10"><i class="fa-solid fa-circle-notch fa-spin text-indigo-600 text-xl"></i><span class="ml-2 text-sm font-bold text-indigo-600">AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô...</span></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3 -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <h4 class="font-bold text-gray-700 mb-4 flex items-center gap-2"><span class="bg-indigo-100 text-indigo-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">3</span> ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (Interest Hunter)</h4>
                        <div class="flex gap-2 mb-4"><input v-model="hunterKeyword" @keyup.enter="searchInterests" type="text" class="flex-1 border border-gray-200 rounded-xl px-4 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤, ‡∏ú‡∏¥‡∏ß‡∏Ç‡∏≤‡∏ß)..."><button @click="searchInterests" :disabled="hunterLoading" class="bg-indigo-600 text-white px-4 py-2 rounded-xl text-sm font-bold shadow hover:bg-indigo-700 transition"><span v-if="!hunterLoading"><i class="fa-solid fa-search"></i> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</span><span v-else><i class="fa-solid fa-circle-notch fa-spin"></i></span></button></div>
                        <div class="mb-4 min-h-[40px] p-2 bg-gray-50 rounded-xl border border-dashed border-gray-200 flex flex-wrap gap-2"><span v-if="launcher.targeting.length === 0" class="text-xs text-gray-400 p-1">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)</span><span v-for="(tag, index) in launcher.targeting" :key="index" class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold flex items-center gap-2 border border-indigo-200">{{ tag.name }} <button @click="launcher.targeting.splice(index, 1)" class="hover:text-red-500"><i class="fa-solid fa-times"></i></button></span></div>
                        <div v-if="interestResults.length > 0" class="max-h-40 overflow-y-auto custom-scrollbar border border-gray-100 rounded-xl"><table class="w-full text-sm text-left"><thead class="bg-gray-50 text-gray-500 text-[10px] uppercase font-bold"><tr><th class="p-2 pl-4">Interest Name</th><th class="p-2">Size</th><th class="p-2 text-right">Action</th></tr></thead><tbody class="divide-y divide-gray-100"><tr v-for="item in interestResults" :key="item.id" class="hover:bg-gray-50"><td class="p-2 pl-4 font-medium text-gray-700">{{ item.name }}</td><td class="p-2 text-gray-500 text-xs">{{ formatNumber(item.audience_size) }}</td><td class="p-2 text-right"><button @click="addInterest(item)" :disabled="launcher.targeting.some(t => t.id === item.id)" :class="launcher.targeting.some(t => t.id === item.id) ? 'bg-gray-100 text-gray-400 cursor-not-allowed border-gray-200' : 'bg-indigo-50 text-indigo-600 hover:text-indigo-800 border-indigo-100 hover:bg-indigo-100'" class="text-xs font-bold px-3 py-1 rounded border transition"><span v-if="launcher.targeting.some(t => t.id === item.id)"><i class="fa-solid fa-check"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß</span><span v-else>+ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span></button></td></tr></tbody></table></div>
                    </div>
                </div>
                <div class="p-6 border-t border-gray-100 bg-white flex justify-end gap-3">
                    <button @click="closeModal" class="px-6 py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-100 transition">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button @click="launchCampaign" :disabled="isLaunching" class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg hover:shadow-xl transition flex items-center gap-2 disabled:opacity-70"><span v-if="!isLaunching">üöÄ ‡∏¢‡∏¥‡∏á‡πÅ‡∏≠‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (Launch)</span><span v-else><i class="fa-solid fa-circle-notch fa-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á...</span></button>
                </div>
            </div>
        </div>

        <!-- Spy Tool -->
        <div v-show="activeModal === 'spy'" style="display: none;" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm" @click.self="closeModal">
            <div class="bg-white rounded-3xl w-full max-w-2xl p-6 shadow-2xl animate-scale-up">
                <div class="flex justify-between items-center mb-6 border-b border-gray-100 pb-4"><div><h3 class="font-bold text-xl text-gray-800 flex items-center gap-2"><i class="fa-solid fa-user-secret text-black"></i> Competitor Spy Tool</h3><p class="text-xs text-gray-400 mt-1">‡πÅ‡∏≠‡∏ö‡∏™‡πà‡∏≠‡∏á‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡πÉ‡∏ô‡∏ï‡∏•‡∏≤‡∏î</p></div><button @click="closeModal" class="w-8 h-8 rounded-full bg-gray-100 text-gray-400 hover:bg-gray-200 hover:text-red-500 transition flex items-center justify-center"><i class="fa-solid fa-times"></i></button></div>
                <div class="flex gap-3 mb-6"><input v-model="spyKeyword" @keyup.enter="searchCompetitors" type="text" class="flex-1 border border-gray-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-black outline-none bg-gray-50" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏à‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á ‡∏´‡∏£‡∏∑‡∏≠ Keyword ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤..."><button @click="searchCompetitors" :disabled="spyLoading" class="bg-black text-white px-6 py-3 rounded-xl text-sm font-bold shadow-lg hover:bg-gray-800 transition flex items-center gap-2"><span v-if="!spyLoading"><i class="fa-solid fa-search"></i> ‡∏™‡πà‡∏≠‡∏á‡πÄ‡∏•‡∏¢</span><span v-else><i class="fa-solid fa-circle-notch fa-spin"></i> ‡∏£‡∏≠‡πÅ‡∏õ‡πä‡∏ö...</span></button></div>
                <div v-if="spyResults.length > 0" class="border border-gray-100 rounded-xl overflow-hidden max-h-[400px] overflow-y-auto custom-scrollbar"><table class="w-full text-sm text-left"><thead class="bg-gray-50 text-gray-500 text-[10px] uppercase font-bold"><tr><th class="p-4">Page Name</th><th class="p-4 text-center">Active Ads</th><th class="p-4 text-right">Action</th></tr></thead><tbody class="divide-y divide-gray-100"><tr v-for="item in spyResults" :key="item.id" class="hover:bg-gray-50 transition"><td class="p-4 font-bold text-gray-800 flex items-center gap-3"><div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-xs text-gray-500"><i class="fa-brands fa-facebook-f"></i></div>{{ item.name }}</td><td class="p-4 text-center"><span class="bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-bold">{{ item.ads_count }} ‡∏ï‡∏±‡∏ß</span></td><td class="p-4 text-right"><a :href="item.link" target="_blank" class="text-blue-600 hover:underline text-xs font-bold border border-blue-200 px-3 py-1.5 rounded-lg hover:bg-blue-50 transition">‡∏î‡∏π‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ <i class="fa-solid fa-external-link-alt ml-1"></i></a></td></tr></tbody></table></div>
                <div v-else-if="spySearched" class="text-center py-10 text-gray-400 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200"><i class="fa-solid fa-ghost text-3xl mb-3 opacity-50"></i><p class="text-sm font-medium">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API</p></div>
            </div>
        </div>

        <!-- Audience Lab -->
        <div v-show="activeModal === 'audience'" style="display: none;" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm" @click.self="closeModal">
            <div class="bg-white rounded-3xl w-full max-w-lg p-6 shadow-2xl animate-scale-up">
                <div class="flex justify-between items-center mb-6 border-b border-gray-100 pb-4">
                    <div><h3 class="font-bold text-xl text-purple-700 flex items-center gap-2"><i class="fa-solid fa-users-viewfinder"></i> Audience Lab</h3><p class="text-xs text-gray-400 mt-1">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ LAL ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏±‡∏Å‡πÄ‡∏û‡∏à</p></div>
                    <button @click="closeModal" class="w-8 h-8 rounded-full bg-gray-100 text-gray-400 hover:bg-gray-200 hover:text-red-500 transition flex items-center justify-center"><i class="fa-solid fa-times"></i></button>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏à‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á</label>
                        <select v-model="audienceForm.pageId" class="w-full border border-gray-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-purple-500 outline-none">
                            <option value="" disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏à --</option>
                            <option v-for="page in facebookPagesList" :key="page.id" :value="page.id">{{ page.name }}</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</label>
                        <select v-model="audienceForm.country" class="w-full border border-gray-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-purple-500 outline-none">
                            <option value="TH">Thailand (‡πÑ‡∏ó‡∏¢)</option>
                            <option value="US">United States</option>
                        </select>
                    </div>
                    <div class="bg-purple-50 p-4 rounded-xl border border-purple-100">
                        <h4 class="font-bold text-purple-800 text-sm mb-2"><i class="fa-solid fa-wand-magic-sparkles"></i> ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÑ‡∏î‡πâ:</h4>
                        <ul class="text-xs text-purple-700 space-y-1 ml-4 list-disc">
                            <li>Custom Audience: ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡∏Å‡πÄ‡∏û‡∏à‡πÉ‡∏ô 365 ‡∏ß‡∏±‡∏ô</li>
                            <li>Lookalike Audience: ‡∏Ñ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô 1% (‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á)</li>
                        </ul>
                    </div>
                    <button @click="createAudience" :disabled="audienceLoading || !audienceForm.pageId" class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-3 rounded-xl font-bold shadow-lg hover:opacity-90 transition disabled:opacity-50">
                        <span v-if="!audienceLoading">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á Audience ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</span>
                        <span v-else><i class="fa-solid fa-circle-notch fa-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Facebook...</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- ‚úÖ Profile Management (Updated) -->
        <div v-show="activeModal === 'profile'" style="display: none;" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm" @click.self="closeModal">
            <div class="bg-white rounded-3xl w-full max-w-md p-6 shadow-2xl animate-scale-up">
                <div class="flex justify-between items-center mb-6 border-b border-gray-100 pb-4">
                    <div><h3 class="font-bold text-xl text-gray-800"><i class="fa-solid fa-user-shield text-indigo-600 mr-2"></i> Profile & Security</h3><p class="text-xs text-gray-400 mt-1">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</p></div>
                    <button @click="closeModal" class="w-8 h-8 rounded-full bg-gray-100 text-gray-400 hover:bg-gray-200 hover:text-red-500 transition flex items-center justify-center"><i class="fa-solid fa-times"></i></button>
                </div>
                <div class="space-y-4">
                    <!-- Email Read-only -->
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">Email (‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ)</label>
                        <div class="relative">
                            <input type="text" :value="user.email" disabled class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm text-gray-500 cursor-not-allowed">
                            <i class="fa-solid fa-lock absolute right-4 top-3.5 text-gray-400"></i>
                        </div>
                    </div>
                    
                    <!-- Password Update -->
                    <div><label class="block text-xs font-bold text-gray-500 mb-1">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</label><input v-model="profileForm.password" type="password" class="w-full border border-gray-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500 outline-none transition" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà"></div>
                    <div><label class="block text-xs font-bold text-gray-500 mb-1">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</label><input v-model="profileForm.confirmPassword" type="password" class="w-full border border-gray-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500 outline-none transition" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"></div>

                    <!-- Actions -->
                    <div class="pt-4 flex gap-2">
                        <button @click="updateProfile" class="flex-1 bg-black text-white py-3 rounded-xl font-bold shadow-lg hover:opacity-90 transition transform active:scale-95">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á</button>
                    </div>
                    
                    <!-- Test Email Button -->
                    <div class="pt-4 border-t border-gray-100 text-center">
                        <button @click="testEmailNotify" :disabled="loading" class="text-xs text-gray-400 hover:text-indigo-600 transition flex items-center justify-center w-full gap-2 py-2 hover:bg-gray-50 rounded-lg"><i class="fa-solid fa-paper-plane"></i> ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏• (Test Email)</button>
                    </div>
                </div>
            </div>
        </div>

        <div v-if="isGhostMode" class="fixed bottom-6 right-6 z-[60] animate-bounce"><button @click="exitGhostMode" class="bg-red-600 text-white font-bold py-3 px-6 rounded-full shadow-2xl border-4 border-white">Exit Ghost Mode</button></div>

    </div>
    <script src="/js/app.js?v=4"></script> 
    <script>setTimeout(() => { const loader = document.getElementById('app-loading'); if(loader) loader.style.display = 'none'; }, 3000);</script>
</body>
</html>